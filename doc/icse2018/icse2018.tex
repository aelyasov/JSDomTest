\documentclass[sigconf]{acmart}

\usepackage{booktabs} % For formal tables
\usepackage{tikz}
\usetikzlibrary{arrows,shadows,positioning}
\usepackage{pgf-umlsd}
\usepackage{tikz-uml}
\usepackage{hyperref}
\usepackage{upquote}
\usepackage{listings}
\usepackage{lsthaskell}
\usepackage{xspace}
\usepackage{algorithmic}
\usepackage{longtable}
\usepackage{longtable}
\usepackage[titlenotnumbered, linesnumbered, ruled]{algorithm2e} % language for algorithm description
\hypersetup{
  colorlinks   = true, %Colours links instead of ugly boxes
  urlcolor     = blue, %Colour for external hyperlinks
  linkcolor    = red, %Colour of internal links
  citecolor    = green %Colour of citations
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\definecolor{ltblue}{rgb}{0,0.4,0.4}
\definecolor{dkblue}{rgb}{0,0.1,0.6}
\definecolor{dkgreen}{rgb}{0,0.4,0}
\definecolor{dkviolet}{rgb}{0.3,0,0.5}
\definecolor{dkred}{rgb}{0.5,0,0}

\definecolor{lightgray}{rgb}{0.95, 0.95, 0.95}
\definecolor{darkgray}{rgb}{0.4, 0.4, 0.4}
%\definecolor{purple}{rgb}{0.65, 0.12, 0.82}
\definecolor{editorGray}{rgb}{0.95, 0.95, 0.95}
\definecolor{editorOcher}{rgb}{1, 0.5, 0} % #FF7F00 -> rgb(239, 169, 0)
\definecolor{editorGreen}{rgb}{0, 0.5, 0} % #007C00 -> rgb(0, 124, 0)
\definecolor{orange}{rgb}{1,0.45,0.13}		
\definecolor{olive}{rgb}{0.17,0.59,0.20}
\definecolor{brown}{rgb}{0.69,0.31,0.31}
\definecolor{purple}{rgb}{0.38,0.18,0.81}
\definecolor{lightblue}{rgb}{0.1,0.57,0.7}
\definecolor{lightred}{rgb}{1,0.4,0.5}
% CSS
\lstdefinelanguage{CSS}{
  keywords={color,background-image:,margin,padding,font,weight,display,position,top,left,right,bottom,list,style,border,size,white,space,min,width, transition:, transform:, transition-property, transition-duration, transition-timing-function},	
  sensitive=true,
  morecomment=[l]{//},
  morecomment=[s]{/*}{*/},
  morestring=[b]',
  morestring=[b]",
  alsoletter={:},
  alsodigit={-}
}

% JavaScript
\lstdefinelanguage{JavaScript}{
  morekeywords={typeof, new, true, false, catch, function, return, null, catch, switch, var, if, in, while, do, else, case, break, for},
  morecomment=[s]{/*}{*/},
  morecomment=[l]//,
  morestring=[b]",
  morestring=[b]'
}

\lstdefinelanguage{HTML5}{
  language=html,
  sensitive=true,	
  alsoletter={<>=-},	
  morecomment=[s]{<!-}{-->},
  morestring=[b]'
  tag=[s],
  otherkeywords={
  % General
  >,
  % Standard tags
	<!DOCTYPE,
  </html, <html, <head, <title, </title, <style, </style, <link, </head, <meta, />,
	% body
	</body, <body,
	% Divs
	</div, <div, </div>, 
	% Paragraphs
	</p, <p, </p>,
	% scripts
	</script, <script,
  % More tags...
  <canvas, /canvas>, <svg, <rect, <animateTransform, </rect>, </svg>, <video, <source, <iframe, </iframe>, </video>, <image, </image>, <header, </header, <article, </article
  },
  ndkeywords={
  % General
  =,
  % HTML attributes
  charset=, src=, id=, width=, height=, style=, type=, rel=, href=,
  % SVG attributes
  fill=, attributeName=, begin=, dur=, from=, to=, poster=, controls=, x=, y=, repeatCount=, xlink:href=,
  % properties
  margin:, padding:, background-image:, border:, top:, left:, position:, width:, height:, margin-top:, margin-bottom:, font-size:, line-height:,
	% CSS3 properties
  transform:, -moz-transform:, -webkit-transform:,
  animation:, -webkit-animation:,
  transition:,  transition-duration:, transition-property:, transition-timing-function:,
  }
}

\lstdefinelanguage{HTML5}{
  language=html,
  tagstyle=\color{blue},
  markfirstintag=true,
  sensitive=true,
  alsoletter={<>=-},	
  morecomment=[s]{<!--}{-->},
  % tag=[s],
  %% morestring=[b]'',
  morestring=[b]',
  ndkeywords={
    % General
    =,
    % HTML attributes
    id=, class= 
  }
}


\lstdefinestyle{htmlcssjs} {%
  % General design
  backgroundcolor=\color{editorGray},
  basicstyle={\scriptsize\ttfamily},   
  frame=tb,
  % line-numbers
  xleftmargin={0.75cm},
  numbers=left,
  stepnumber=1,
  firstnumber=1,
  numberfirstline=true,	
  % Code design
  identifierstyle=\color{black},
  keywordstyle=\color{blue}\bfseries,
  ndkeywordstyle=\color{editorGreen}\bfseries,
  stringstyle=\color{editorOcher}\ttfamily,
  commentstyle=\color{brown}\ttfamily,
  % Code
  language=JavaScript,
  alsolanguage=HTML5,
  alsodigit={.:;},	
  tabsize=2,
  showtabs=false,
  showspaces=false,
  showstringspaces=false,
  extendedchars=true,
  breaklines=true,
  escapechar=|c
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\listfiles % used to output the versions of all files being used by the latex

\newcommand{\Server}{\emph{Server}\xspace}
\newcommand{\Client}{\emph{Client}\xspace}
\newcommand{\User}{\emph{User}\xspace}
\newcommand{\Validator}{\emph{Validator}\xspace}
\newcommand{\thenBr}{\text{then}}
\newcommand{\elseBr}{\text{else}}
\newcommand{\inFor}{\text{inFor}}
\newcommand{\inWhile}{\text{inWhile}}


% Copyright
%\setcopyright{none}
%\setcopyright{acmcopyright}
%\setcopyright{acmlicensed}
\setcopyright{rightsretained}
%\setcopyright{usgov}
%\setcopyright{usgovmixed}
%\setcopyright{cagov}
%\setcopyright{cagovmixed}


% DOI
\acmDOI{10.475/123_4}

% ISBN
\acmISBN{123-4567-24-567/08/06}

%Conference
\acmConference[WOODSTOCK'97]{ACM Woodstock conference}{July 1997}{El
  Paso, Texas USA} 
\acmYear{1997}
\copyrightyear{2016}

\acmPrice{15.00}


\begin{document}
\title{Search-Based Test Data Generation for JavaScript Functions with DOM}


%% \author{
%%   \alignauthor Alexander Elyasov, Wishnu Prasetya, Jurriaan Hage\\ 
%%   \affaddr{Utrecht University, The Netherlands}\\
%%   \email{\{a.elyasov,s.w.b.prasetya,j.hage\}@uu.nl}
%% }

\author{Alexander Elyasov}
\affiliation{%
  \institution{Utrecht University}
  \city{Utrecht} 
  \country{The Netherlands} 
}
\email{a.elyasov@uu.nl}

\author{Wishnu Prasetya}
\affiliation{%
  \institution{Utrecht University}
  \city{Utrecht} 
  \country{The Netherlands} 
}
\email{s.w.b.prasetya@uu.nl}

\author{Jurriaan Hage}
\affiliation{%
  \institution{Utrecht University}
  \city{Utrecht} 
  \country{The Netherlands} 
}
\email{j.hage@uu.nl}


\begin{abstract}
This paper provides a sample of a \LaTeX\ document which conforms,
somewhat loosely, to the formatting guidelines for
ACM SIG Proceedings.\footnote{This is an abstract footnote}
\end{abstract}

%
% The code below should be generated by the tool at
% http://dl.acm.org/ccs.cfm
% Please copy and paste the code instead of the example below. 
%
\begin{CCSXML}
TODO 
\end{CCSXML}

\ccsdesc[500]{Computer systems organization~Embedded systems}
\ccsdesc[300]{Computer systems organization~Redundancy}
\ccsdesc{Computer systems organization~Robotics}
\ccsdesc[100]{Networks~Network reliability}


\keywords{ACM proceedings, \LaTeX, text tagging}


\maketitle


\section{Introduction}
\label{sec.intro}
Recent empirical study of client-side JavaScript bugs~\cite{frolin:TSE16} has shown that 68\% of faults are DOM related.

Another empirical work~\cite{richards2010analysis}.

%% --------------------------------------------------------------------
\section{Motivating Example}
\label{sec.example}
%% --------------------------------------------------------------------

\begin{figure}[t]
  \begin{lstlisting}[style=htmlcssjs,language=JavaScript]
/*t dom */
function isGameFinished() {
  var obj = document.getElementById('sudoku'); |c \label{isGameFinished.getSudoku} |c
  var subDivs = obj.getElementsByTagName('DIV'); |c \label{isGameFinished.getDivs} |c
  var allOk = true;
  for (var no = 0; no < subDivs.length; no++) { |c \label{isGameFinished.inFor.begin} |c
    if (subDivs[no].className.indexOf('sudokuSquare') >= 0 |c \label{isGameFinished.if1.begin} |c 
        && !subDivs[no].style.backgroundColor) { 
      var spans = subDivs[no].getElementsByTagName('SPAN');
      if (spans[0].innerHTML != spans[1].innerHTML) { |c \label{isGameFinished.if2.begin} |c
        allOk = false; |c \label{isGameFinished.unfinished} |c
        break;
      } |c \label{isGameFinished.if2.end} |c
    } |c \label{isGameFinished.if1.end} |c
  } |c \label{isGameFinished.inFor.end} |c
  if (allOk) { |c \label{isGameFinished.if3.begin} |c 
    console.log('Congratulations! You did it'); |c \label{isGameFinished.finished} |c
  } |c \label{isGameFinished.if3.end} |c
}
\end{lstlisting}
  \caption{JS function \texttt{isGameFinished.js} from sudoku}
  \label{code.newGame}
\end{figure}

\begin{figure}[t]
  \begin{lstlisting}[style=htmlcssjs,language=JavaScript]
function isGameFinished() {
  trace.push(2);
  var obj = document.getElementById("sudoku");
  trace.push(3);
  var subDivs = obj.getElementsByTagName("DIV");
  trace.push(4);
  var allOk = true;
  loopMap[5] = function () {
    var no = 0;
    if (subDivs.length || subDivs.length == 0) {
      return Math.abs(no - subDivs.length);
    }
    return 1;
  }();
  for (var no = 0; no < subDivs.length; no++) {
    trace.push(5);
    trace.push(6);
    trace.push(7);
    if (subDivs[no].className.indexOf("sudokuSquare") >= 0 &&
        !subDivs[no].style.backgroundColor) {
      trace.push(8);
      branchDistance.push({ 
        label: 7, 
        distance: Math.min(
          abs(subDivs[no].className.indexOf("sudokuSquare"), 0) + _K_,
          absZero(subDivs[no].style.backgroundColor))
      });
      trace.push(9);
      var spans = subDivs[no].getElementsByTagName("SPAN");
      trace.push(10);
      if (spans[0].innerHTML != spans[1].innerHTML) {
      trace.push(11);
      branchDistance.push({
        label: 10,
        distance: abs(spans[0].innerHTML, spans[1].innerHTML)
      });
      trace.push(12);
      allOk = false;
      break;
      } else {
        trace.push(14);
        branchDistance.push({label: 10,distance: _K_});
      }
    } else {
      trace.push(15);
      branchDistance.push({
        label: 7,
        distance: abs(subDivs[no].className.indexOf("sudokuSquare"), 0) +
                  absNegZero(subDivs[no].style.backgroundColor)
      });
    }
  }
  trace.push(5);
  trace.push(16);
  if (allOk) {
    trace.push(17);
    branchDistance.push({label: 16, distance: absNegZero(allOk)});
    trace.push(18);
    console.log("Congratulations! You did it");
  } else {
    trace.push(19);
    branchDistance.push({label: 16 ,distance: absZero(allOk)});
  }
  trace.push(-1);
}
\end{lstlisting}
  \caption{Instrumented version of the function \texttt{isGameFinished.js} }
  \label{code.isGameFinished.instr}
\end{figure}

\begin{figure}[t]
  \begin{lstlisting}[style=htmlcssjs, language=HTML5]
<!-- T1 covers: (6,15), (16,17) -->
<html>
  <body>
    <div id='sudoku'></div>
</body>
</html>

<!-- T2 covers: (6,7), (7,14), (16,17) -->
<html>
  <body>
    <div id='sudoku'>
      <div></div>
    </div>
  </body>
</html>

<!-- T3 covers: (6,7), (7,9), (10,13), (16,17) -->
<html>
  <body>
    <div id='sudoku'>
      <div class='sudokuSquare'>
        <span></span>
        <span></span>
      </div>
    </div>
  </body>
</html>

<!-- T4 covers: (6,7), (7,9), (10,11), (16,18) -->
<html>
  <body>
    <div id='sudoku'>
      <div class='sudokuSquare'>
        <span></span>
        <span>TEST</span>
      </div>
    </div>
  </body>
</html>
  \end{lstlisting}
  \caption{Input DOM arguments for \texttt{isGameFinished.js}}
  \label{fig.isGameFinished.tests}
\end{figure}

Let us consider JS function \texttt{isGameFinished} in Figure~\ref{code.newGame} taken from the web application game \emph{sudoku}~\ref{ref.sudoku}. This function checks if a sudoku solution entered by the user is valid. First, it finds the game field element (line~\ref{isGameFinished.getSudoku}), retrieves all child divs (line~\ref{isGameFinished.getDivs}), and iterates over that collection. Each div element which corresponds to a sudoku input square (line~\ref{isGameFinished.if1.begin}) consists of two span elements. One contains a user input, and another one, which is hidden at the moment, stores the expected value for the sudoku square. Once, it finds a square where two values are not equal (line~\ref{isGameFinished.if2.begin}) to each other, the game is considered unfinished (line~\ref{isGameFinished.unfinished}) and finished otherwise (line~\ref{isGameFinished.finished}).

Suppose now that we would like to (unit) test this function in isolation to the rest of the application source code. We aim to maximize branch coverage as a common testing criteria~\cite{why_is_common}. That is for each individual branch of the function under test (FUT) \texttt{isGameFinished}, we have to construct a test input which passes the branch and normally exists the function. JS function has \emph{explicit} input arguments (none is our case), but it can also has \emph{implicit} arguments such as DOM state. As assume that DOM is the only global JS object that can be referred from the body of FUT. So in order to test our function we have to construct appropriate DOM objects as test inputs.   

%Our program has the following branches: $(6,15)$, $(6,7)$, $(7,9)$, $(7,14)$, $(10,11)$, $(10,13)$, $(16,17)$, $(16,18)$. Four tests in 

Figure~\ref{fig.isGameFinished.tests} presents four tests that together provide full coverage of the FUT. Let us look at how to construct the test that covers branch $(10,11)$. Line~\ref{isGameFinished.getSudoku} expects DOM to have an element with the id \textquotesingle\texttt{sudoku}\textquotesingle. In order to enter the for-loop on line~{isGameFinished.inFor.begin}, this element should have at least one child of the type $div$. The condition of the first $if$ (line~\ref{isGameFinished.if1.begin}) requires the div to be of the class \textquotesingle\texttt{sudokuSquare}\textquotesingle and have no background color. The last if-condition (line~\ref{isGameFinished.if2.begin}) expects that the div has two \emph{span} elements whose \emph{innerHtml} values are not equal. $T4$ in Figure~\ref{fig.isGameFinished.tests} shows a concrete example of DOM that meets all the conditions above. 

As we have just seen even for such a relatively simple example, the construction of the test input is a far from trivial procedure because it requires deep understanding the program's semantics. In practice, web developers often have to deal with the gazillion of the JS frameworks and libraries freely available on the GitHub. This code is commonly untested and poorly documented. At the same time, unit testing is the most fundamental and easiest to provide level of testing. It greatly saves developers from the unexpected regression and creates a safety belt around the application.

%% --------------------------------------------------------------------
\section{Test Generation Framework}
\label{sec.framework}
%% --------------------------------------------------------------------

\begin{figure}
  \centering 
  \begin{sequencediagram}[font=\scriptsize]
    \newinst{user}{User}
    \newinst{server}{Server}
    \newinst[1]{validator}{Validator}
    \newinst{client}{Client}
    
    \begin{call}{user}{fun.js + config}{server}{\textbf{end}}
      \begin{call}{server}{Initialize(fun.js)}{server}{(cfg, branches, cinfo, ifun, sig)}
      \end{call}
      
      \begin{call}{server}{POST /init \{ifun, sig\}}{client}{status}
      \end{call}
      
      \begin{call}{server}{Select(branches)}{user}{$\text{branches}'$}       
      \end{call}
      
      \begin{sdblock}{Genetic Loop}{\hspace{2mm}$\text{branch} \in \text{branches}'$}
        \begin{sdblock}{Random Loop}{errors > 0}
          \begin{call}{server}{pop = Random(cinfo, config)}{validator}{errors}
          \end{call}
          \prelevel
        \end{sdblock}
        
        \begin{sdblock}{Fitness Loop}{(fitness $\neq$ 0) $\vee$ gen.limit}

          \begin{sdblock}{Evaluation Loop}{p $\in$ pop}
            \begin{call}{server}{POST /genetic \{p\}}{client}{response = ifun(p: sig)}
            \end{call}
            
            \begin{callself}{server}{Evaluate(branch, cfg, response)}{fitness}
            \end{callself}
            \prelevel
          \end{sdblock}
          
          \begin{sdblock}{Crossover Loop}{errors > 0}
            \begin{call}{server}{cross = Crossover(pop)}{validator}{errors}
            \end{call}
            \prelevel
          \end{sdblock}

          \begin{sdblock}{Mutation Loop}{errors > 0}
            \begin{call}{server}{mut = Mutation(cinfo, pop)}{validator}{errors}
            \end{call}
            \prelevel
          \end{sdblock}
         
          \begin{callself}{server}{cross $\cup$ mut}{pop}
          \end{callself}
          \prelevel
        \end{sdblock}
        \mess{server}{best fitness}{user}
        
      \end{sdblock}
    \end{call}
  \end{sequencediagram}
  \caption{Architecture of the test framework}
  \label{fig.framework.architect} 
\end{figure}

Given JS function $f$ and some set of its branches $B_f$, the purpose of our testing framework is to generate input arguments for $f$ that trigger executions covering all branches in $B_f$. The general workflow of the test generation process is represented as a sequence diagram in Figure~\ref{fig.framework.architect}. The diagram consists of four interacting components: \User, \Server\, \Validator and \Client. \Server is the key one. It performs all preparatory steps (\emph{Initialization Phase}) as well as controls the data generation (\emph{Genetic Phase}). These two phases will be covered in details in Section~\ref{sub.sec.init.phase} and \ref{sub.sec.genetic.phase} respectively. Every request sent to \Validator\footnote{\url{https://validator.w3.org/nu/}} with an HTML document as the body triggers a response containing the list of syntactic errors in that document. \Client is a \emph{Node.js}\footnote{\url{https://nodejs.org/en/}} application that is mainly responsible for the execution of the JavaScript code. It relies on the \emph{jsdom}\footnote{\url{https://github.com/tmpvar/jsdom}} library simulating calls to native DOM. 

Let us get a closer look at the sequence of interactions in Figure~\ref{fig.framework.architect}. First, \User provides JS file \emph{fun.js} that defines the function under test (FUT) \emph{fun} annotated with its type. Additionally, user supplies a configuration file \emph{config} that parameterizes some settings related to the genetic algorithm, random generation, logging etc. These data are processed by \Server in the \emph{Initialization Phase}. As an output we get a tuple with the following information about $fun$: control flow graph (\emph{cfg}), list of branches (\emph{branches}), static information about constants (\emph{cinfo}), instrumented function (\emph{ifun}) and the function's signature (\emph{sig}). \Server sends a \texttt{POST} request to the \Client to store \emph{ifun} and \emph{sig}. Second, \Server asks \User to select a branch(s) that has to be covered by the execution of \emph{fun}. For each branch our framework enters the \emph{Genetic Loop}. Inside of this phase it starts with a randomly generated population (\emph{Random Loop}), and continues to optimize it until earthier perfect fitness is found or generation limit is exceeded. Each candidate in the population has to be evaluated (\emph{Evaluation Loop}). To do so \Client parses the candidate according the known signature \emph{sig}, invokes \emph{ifun} on the result, collects some information along the execution and sends it back to \Server, where the final fitness value is computed for the candidate. New population is formed as the joint result of the \emph{Crossover} and \emph{Mutation Loop}. These two loops together with the \emph{Random} one are performed in conversation with \Validator. It forces to proceed generation until no more errors are present in the data. At the end of the \emph{Fitness Loop} the best candidate with the best fitness value are reported back to \User. After exploring all branches \emph{Genetic Loop} terminates. 

\subsection{Initialization Phase}
\label{sub.sec.init.phase}

\begin{algorithm}[t!]
  \caption{Initialization Phase}
  \label{alg.init}
  \algsetup{linenosize=\tiny}
  \scriptsize
  \DontPrintSemicolon
  \SetAlgoVlined
  \SetKwInOut{Input}{Input}
  \SetKwInOut{Output}{Output}
  \SetKwInOut{Require}{Require}
  \SetKwProg{Fn}{Function}{}{}
  \Input{
    $fun.js$ is a JS file with FUT and type annotation
  }
  \Output{
    tuple with $(cfg, branches, cinfo, ifun, sig)$
  }
  \Fn{$Initialize(fun.js)$}{
 
    $(ast, sig) \longleftarrow ParseFunAndSig(fun.js)$\label{alg.init.parse.fun.sig}\;
    $cinfo \longleftarrow GetConstInfo(ast)$\label{alg.init.collect.info}\;
    $ast \longleftarrow NormalizeAST(ast)$\label{alg.init.transform.ast}\;
    $cfg \longleftarrow BuildCFG(ast)$\label{alg.init.build.cfg}\;
    $branches \longleftarrow GetBranches(cfg)$\label{alg.init.get.branches}\;
    $ifun \longleftarrow Instrument(ast)$\label{alg.init.instr}\;
    \Return{$(cfg, branches, cinfo, ifun, sig)$}
    }
\end{algorithm}

The goal of the \emph{Initialization Phase} is to prepare FUT for the follow up \emph{Genetic Phase}. The main steps of the initialization are illustrated in Algorithm~\ref{alg.init}. Given the file \emph{fun.js} as an input, we separately parse the function and its signature in line~\ref{alg.init.parse.fun.sig}. Currently our framework recognizes signatures composed of four primitive types such as \texttt{bool}, \texttt{int}, \texttt{float}, \texttt{string} and a newly introduced type \texttt{dom}. To facilitate random generation in the \emph{Genetic Phase} we statically analyze the FUT to collect useful data about potential string and numeric constants (line~\ref{alg.init.collect.info}). Moreover, we track calls to such browser API methods as \texttt{getElementsByTagName}, \texttt{getElementById}, \texttt{getElementsByClassName}, \texttt{getElementsByName}, which gives us information about \emph{tags}, \emph{ids}, \emph{classes} and \emph{names} respectively. Knowing this data significantly increases our chances to produce a desired test input. Sometimes it is necessary to normalize FUT before applying instrumentation (line~\ref{alg.init.transform.ast}), e.g. we transform \emph{if-then} branches to \emph{if-then-else}. After the normalization we can build CFG (line~\ref{alg.init.build.cfg}) and get all branches (line~\ref{alg.init.get.branches}). The final step is to instrument \emph{fun} (line~\ref{alg.init.instr}) in order to collect some run-time data such as execution trace, branch and loop distances, and constants. This data will be required for fitness evaluation (Section~\ref{sub.sub.sec.fitness.fun}) and updating of \emph{cinfo}.

\subsection{Genetic Phase}
\label{sub.sec.genetic.phase}

\begin{algorithm}[!t]
  \caption{Genetic Phase}
  \label{alg.gen}
  \algsetup{linenosize=\tiny}
  \scriptsize
  \DontPrintSemicolon
  \SetAlgoVlined
  \SetKwInOut{Input}{Input}
  \SetKwInOut{Output}{Output}
  \SetKwInOut{Require}{Require}
  \SetKwProg{Fn}{Function}{}{}
  \Input{
    $b_N$ is target branch, $cfg$ is control-flow graph\\
    $cinfo$ is constant info, $config$ is configuration file\\
    $ifun$ instrumented JS function, $sig$ type signature
  }
  \Output{
     element $p^*$ on which the best fitness $f^*$ is achieved  
  }
  \Fn{$Genetic(b_N, cfg, cinfo, config, ifun, sig)$}{
    $(size_P, size_A, size_G, rate_C, rate_M) \longleftarrow Read(config)$\label{alg.gen.read.config}\;
    $archive \longleftarrow \emptyset$; $i \longleftarrow 0 $\label{alg.gen.arch.init}\;
    $pop \longleftarrow Random(cinfo, size_P)$\label{alg.gen.random.gen}\;
    \Repeat{$isPerfect(f^*) \vee i > size_G $}{\label{alg.gen.loop.begin}
      $scoredPop \longleftarrow \emptyset$\;
      \ForAll{$p \in pop$}{\label{alg.gen.eval.begin}
        $args \longleftarrow MakeArguments(p, sig)$\label{alg.gen.make.args}\;
        $(tr, d_B, d_L, consts) \longleftarrow ifun(args)$\label{alg.gen.call.ifun}\;
        $f \longleftarrow Evaluate(b_N, cfg, tr, d_B, d_L)$\label{alg.gen.eval}\;
        $scoredPop \longleftarrow (f, p) \cup scoredPop$\;
        $cinfo \longleftarrow consts \cup cinfo$\label{alg.gen.eval.end}\;
      }
      $combo \longleftarrow scoredPop \cup archive$\label{alg.gen.get.combo}\;
      $cross \longleftarrow Crossover(combo, rate_C)$\label{alg.gen.cross}\;
      $mut \longleftarrow Mutation(combo, cinfo, rate_M)$\label{alg.gen.mut}\;
      $pop \longleftarrow cross \cup mut$\label{alg.gen.new.pop}\;
      $archive \longleftarrow SortArchive(combo, size_A)$\label{alg.gen.new.archive}\;
      $(f^*, p^*) \longleftarrow head(archive)$\label{alg.gen.archive.head}\;
      $i \longleftarrow i + 1$\;
    }\label{alg.gen.loop.end}
    \Return{$(f^*, p^*)$}\label{alg.gen.return} 
  }
\end{algorithm} 

The heart of our test data generation framework is in the \emph{Genetic Phase}. The main workflow of the underlying genetic algorithm (GA) is quite standard~\cite{poli2008field}, and with some adjustments is presented in Algorithm~\ref{alg.gen}. First, we read the \emph{config} file in line~\ref{alg.gen.read.config}. As a result, we get information about the number of elements in a population ($size_P$), size of the archive ($size_A$), number of generations ($size_G$) and respectively crossover ($rate_C$) and mutation ($rate_M$) rates. \emph{Archive} has the capacity of $size_A$ elements and stores the most fitted candidates observed so far. It is empty in the beginning of the evolution (line~\ref{alg.gen.arch.init}). The first population consisting of $size_P$ elements is randomly constructed from the elements in \emph{cinfo} (line~\ref{alg.gen.random.gen}). Inside of the loop (lines~\ref{alg.gen.loop.begin}-\ref{alg.gen.loop.end}) we are evolving the population until either the perfect fitness is found or the generation limit $size_G$ is reached. But first step in this loop is to score the current population~\ref{alg.gen.eval.begin}-\ref{alg.gen.eval.end}. Each candidate in the population has to be converted to an argument list by coercing it to a respective type according to the signature $sig$ (line~\ref{alg.gen.make.args}). Calling the instrumented function $ifun$ on those arguments (line~\ref{alg.gen.call.ifun}), we get 4-tuple consisting of the execution trace ($tr$), the branch distances ($d_B$), the loop distances ($d_L$) and the new set of constants ($consts$) collected at the run time. The next step is actually to evaluate the fitness value of the given candidate (line~\ref{alg.gen.eval}). Collected constants $consts$ are added to the existing constants info $cinfo$ (line~\ref{alg.gen.eval.end}). Eventually the scored population is combined with the archive (line~\ref{alg.gen.get.combo}) and is used for the crossover (line~\ref{alg.gen.cross}) and mutation steps (line~\ref{alg.gen.mut}). The rates specify the distribution in which the respective operations are applied to produce the new population (line~\ref{alg.gen.new.pop}). Scored population together with the current archive are sorted based on the fitness value, and the best $size_A$ elements form the new archive (line~\ref{alg.gen.new.archive}). On top of the archive we have the most fitted candidate observed over the course of all iterations (line~\ref{alg.gen.archive.head}). The fitness value of that element defines if perfect candidate is found (line~\ref{alg.gen.loop.end}) and it is return at the end of the algorithm (line~\ref{alg.gen.return}).

In order to instantiate genetic algorithm for a particular problem, its user has to define all the aforementioned operations specific for the problem in question. Since GAs have been commonly used for generation of test data for primitive types such as integers and strings~\cite{paper_on_search-based_test_case_generation}, we skip their definitions and rather focus or the interesting case, namely, HTML generation.  

\subsubsection{Random HTML Generation}
\label{sub.sub.sec.random.html}

We want to generate HTML as it is specified by WHATWG\footnote{\url{https://html.spec.whatwg.org}}. HTML is an XML-family markup language that uses special tags and attributes to describe document structures on the Web. Recent HTML5 standard defines more than hundred of tags and attributes which both have to comply with extremely complex logic to constitute a syntactically valid HTML. Browsers are usually tolerant to syntactic errors in HTML. They will silently fix them and display the page anyway.

In order to support the variability of HTML content, we have developed an eDSL that prescribes the generation of syntactically valid HTML. This was a challenge on its own because, as we have mentioned early, the complexity of HTML and lack of formal specification. Our language is inspired by QuickCheck~\cite{claessen2011quickcheck} and essentially employs the library\footnote{\url{https://hackage.haskell.org/package/QuickCheck}} to define an \texttt{Arbitrary} instance for the \texttt{Html} data type. With some technical details left out for the sake of simplicity, Figure~\ref{fig.html.arb.def} highlights that definition. Data type \texttt{HtmlState} (lines~\ref{ref.HtmlState.begin}--\ref{ref.HtmlState.end}) describes the internal state of \texttt{Html} during generation. The state is composed of the following components:
\begin{itemize}
\item \texttt{depth} and \texttt{degree} specify maximum depth and node degree of HTML respectively
\item \texttt{ctx} is the current value of the HTML content model stack 
\item \texttt{tagFreq} provides statistical information about the frequency of tags in HTML
\item \texttt{tags}, \texttt{ids} and \texttt{classes} are predefined sets of HTML elements which are given preference in the generation process.  
\end{itemize}
Combined with the random generation monad \texttt{Gen}, this state is wrapped into a state monad transformer~\cite{jones1995functional} (line~\ref{ref.GenState}) which returns the randomly generated \texttt{Html} (line~\ref{ref.GenHtmlState}). Each HTML tag should be defined as a value of type \texttt{GenHtmlState}. Lines~\ref{ref.generateHTML.begin}--\ref{ref.generateHTML.end} show an example of content generation for the \texttt{<html>} tag. According to its specification\footnote{\url{https://html.spec.whatwg.org/multipage/semantics.html\#the-html-element}}, the tag is composed of the \texttt{<head>} tag followed by the \texttt{<body>} tag. First, we store the state of HTML generation and retrieve the current the depth (lines~\ref{ref.generateHTML.getState} and \ref{ref.generateHTML.getDepth} respectively). Then, if depth is equal to zero, we just return some string constant (line~\ref{ref.generateHTML.returnString}). Otherwise, we update the state with the depth decreased by one, generate new content for \texttt{head} and \texttt{body}, and return their combination (lines~\ref{ref.generateHTML.updateState}, \ref{ref.generateHTML.newHead}, \ref{ref.generateHTML.newBody} and \ref{ref.generateHTML.end} respectively).

\begin{figure}[t]
  \begin{haskell}
instance Arbitrary Html where
  arbitrary = evalStateT generateHTML defaultState

generateHTML :: GenHtmlState |c \label{ref.generateHTML.begin} |c
generateHTML = do
  state <- get |c \label{ref.generateHTML.getState} |c   
  let d = getDepth state |c \label{ref.generateHTML.getDepth} |c
  if d == 0
  then lift \dollar return \dollar toHtml "HTML" |c \label{ref.generateHTML.returnString} |c
  else do put state{depth = d - 1} |c \label{ref.generateHTML.updateState} |c
           head <- generateHEAD |c \label{ref.generateHTML.newHead} |c
           body <- generateBODY |c \label{ref.generateHTML.newBody} |c
           lift\dollar return \dollar docTypeHtml \dollar head >> body |c \label{ref.generateHTML.end} |c

data Tag = HTML | HEAD | BODY | ...
type Context = CFlow | CMetadata | ...
data HtmlState = |c \label{ref.HtmlState.begin} |c
  HtmlState { depth      :: Int 
             , degree    :: Int    
             , ctx       :: Stack Context 
             , tagFreq   :: [(Int, Tag)] 
             , tags      :: [Tag]
             , ids       :: [String]
             , classes   :: [String] } |c \label{ref.HtmlState.end} |c
type GenState s = StateT s Gen |c \label{ref.GenState} |c
type GenHtmlState = GenState HtmlState Html |c \label{ref.GenHtmlState} |c
  \end{haskell}
  \caption{\texttt{Arbitrary} instance for \texttt{Html} data type}
  \label{fig.html.arb.def}
\end{figure}

\subsubsection{Genetic HTML Operations}
\label{sub.sub.sec.genetic.oper}

In essence, HTML document is a labeled tree with \emph{tags} instead of nodes and \emph{attributes} as labels. Therefore crossover and mutations are defined similar to those concepts for the expression trees in genetic programming.  

\textbf{HTML Crossover} takes two HTML trees, randomly picks a node in each tree, and returns the first tree with a sub-tree swapped from the second tree.

\textbf{HTML Mutations} are of three categories: \emph{NewTree}, \emph{DropTree}, and \emph{ShuffleAttributes}. \emph{NewTree} simply generate a new tree based on the given state of constant pool. \emph{DropTree} mutation selects a node in a tree and drops the sub-tree starting from that node. \emph{ShuffleAttributes} for a given tree and an attribute type, re-assigns the attributes of the specified type on that tree. Currently we instantiated the \emph{ShuffleAttributes} mutation for only for two types of attributes \emph{class} and \emph{id}, which gave us it total four variations for mutation. Each time a mutation is performed the type is chosen uniformly. In the future we consider experiment with assigning some priorities to curtain mutations.  

\subsubsection{Fitness Function}
\label{sub.sub.sec.fitness.fun}

Success of any search-based algorithm heavily relies on the choice of the fitness function (FF) that guides the evolution process. Our search target is a specific branch of the program under test that we want to cover by generating a valid input data. The input is \emph{valid} only if the program normally terminates on it, i.e. without premature exception. Thus, our search target is an ordered pair of CFG nodes $(n_b, n_x)$ where $n_b$ is the label of the target branch, and $n_x$ is the normal exit node of the program. FF for a CFG node is traditionally defined as a combination of the \emph{approach level} and the normalized \emph{branch distance}\cite{arcuri2010does}. 
\[
\mathcal{F}(n) = \text{Approach Level} + \alpha({\text{Branch Distance}})
\]

Therefore, the resulted FF ($\mathcal{F}^*$) is an ordered pair of the FFs of the respective nodes.   

\[
\mathcal{F}^*(n_b, n_x) = (\mathcal{F}(n_b), \mathcal{F}(n_x))
\]

%% --------------------------------------------------------------------
\section{Empirical Evaluation}
\label{sec.evaluation}
%% --------------------------------------------------------------------

In order to evaluation the feasibility of practical adoption of our genetic test generation framework, we carried out empirical validation on a set of case studies. Table~\ref{tbl.gen.config} shows summary of configuration parameters for both random and genetic instances of our framework.  As a baseline we implemented random test generation strategy. It is similar to the genetic one except that it won't performing crossover and mutation. Hence, it also benefits from initial static analysis and follow up dynamic constant propagation. In addition, we experimented with two different sizes (5 and 10) for genetic restart in case of archive convergence.

\begin{table}
  \caption{Genetic Algorithm Configurations}
  \label{tbl.gen.config}
    \footnotesize
  \begin{tabular}{l|r|r}
    \toprule
    \textbf{Parameter Name} & \textbf{Random} & \textbf{Genetic} \\
    \midrule
    Population size                   & 50  & 50 \\
    Archive size                      & 1   & 25 \\
    Maximum number of generations     & 200 & 200 \\
    Crossover rate                    & 0   & 0.5 \\
    Mutation rate                     & 0   & 0.5 \\
    Restart after archive convergence & -   & - (5,10) \\
    \bottomrule
  \end{tabular}
\end{table}


\subsection{Case Studies}
\label{sub.sec.case.studies}

Being one of the most popular programming languages of the modern time, there are ample open source JS projects on the web. They all are greatly vary in size, complexity and coding style. Moreover, many popular JS web-frameworks, including jQuery and React\footnote{\url{http://todomvc.com/}}, offer an alternative approach for DOM manipulation to vanilla-like JS. Therefore, search for appropriate case-studies requires careful inspection of the application source code, which is often time consuming and labor intensive process. These factors significantly complicate the choice of suitable evaluation subjects. Therefore, we decided to form our experimental data set from two related research works \emph{Confix}~\cite{amin:ase15} and \emph{TAJS}\footnote{\url{http://www.brics.dk/TAJS/dom-benchmarks/}}~\cite{dom2011}. Moreover, we introduced two additional subjects found in open source \emph{mathjs}\footnote{\url{https://github.com/josdejong/mathjs/}} and \emph{cs-in-js}\footnote{\url{https://github.com/nzakas/computer-science-in-javascript}}. For each case study application, we identified several JS functions which were suitable for our test generation framework. Our evaluation set includes both primitive and manipulating with DOM JS functions.

Table~\ref{tbl.case.studies} presents common quantitative characteristics of the selected functions such as the number of branches (\textbf{\#BR}), lines of code (\textbf{\#LOC}) and cyclomatic complexity (\textbf{CC}). The four rightmost columns \textbf{DOM}, \textbf{id}, \textbf{tag} and \textbf{class} indicate if the function manipulates with the \emph{dom}, \emph{id}, \emph{tag} or \emph{class} respectively.       


Consider examples from: \cite{artemis2011}, \cite{dom2011}...

To report on cyclomatic complexity we use \emph{jshint}\footnote{http://jshint.com/} (we can also use this tool\footnote{http://jsmeter.info/})

\begin{table*}
  \caption{Summary of the case studies}
  \label{tbl.case.studies}
  %\resizebox{\textwidth}{!}{
    \footnotesize
  \begin{tabular}{l|l|l|r|r|r|r|c|c|c|c}
    \toprule
    \textbf{case-study} & \textbf{function} & \textbf{type} & \textbf{\#LOC} & \textbf{\#BR} & \textbf{\#D} & \textbf{CC} & \textbf{DOM} & \textbf{id} & \textbf{tag} & \textbf{class} \\
    \midrule
    sudoku     & helpMe & (dom,int,int)                                   & 15 & 2  & 3 & 3  & + & + & + & - \\
    sudoku     & isGameFinished & (dom)                                   & 17 & 4  & 3 & 5  & + & + & + & + \\
    sudoku     & newGame & (dom)                                          & 12 & 1  & 2 & 2  & + & + & + & + \\
    sudoku     & revealAll & (dom)                                        & 14 & 0  & 2 & 1  & + & + & + & - \\
    sudoku     & showCell & (dom)                                         &    &    &   &    &   &   &   & \\
    sudoku     & shuffleBoard & (dom)                                     & 26 & 2  & 3 & 3  & + & - & + & - \\
    sudoku     & switchLevel & (dom,bool)                                 &    &    &   &    &   &   &   & \\
    \midrule
    phormer    & toggleInfo & (dom,string)                                & 15 & 3  & 1 & 4  & + & + & - & - \\
    phormer    & update & (dom,int,[string],bool,[string],[string],bool,[string],[string],int) &    &    &   &    &   &   &   & \\
    phormer    & updateIndic & (dom,bool)                                 &    &    &   &    &   &   &   & \\
    \midrule
    hotelRS    & RequiredField & (dom,[string])                           &    &    &   &    &   &   &   & \\
    hotel RS   & isValidCard & ([int])                                    & 20 & 2  & 2 & 5  & - & - & - & - \\
    hotel RS   & isValidMasterCard & ([int])                              & 6  & 4  & 1 & 7  & - & - & - & - \\
    hotelRS    & isValidVISA & ([int])                                    &    &    &   &    &   &   &   & \\
    hotelRS    & validateNumber & (dom,string)                            &    &    &   &    &   &   &   & \\
    \midrule
    apophis    & doRain & (dom,string,int,int,int,int,int,int)            &    &    &   &    &   &   &   & \\
    apophis    & drawShields & (dom,[int])                                &    &    &   &    &   &   &   & \\
    apophis    & fireMeteor & (int,[int],int,[int],[int],[int],int,int,[int],[int],int,int,int) &    &    &   &    &   &   &   & \\
    apophis    & getReady & (dom,int,int,int,int,int,int)                 &    &    &   &    &   &   &   & \\
    apophis    & initShields & (dom,[int],int,int)                        & 8  & 0  & 1 & 1  & + & + & - & -\\
    \midrule
    bingbong   & brickJiggler & (dom,int,int,int,[int],[int],[int],[int]) & 7  & 1  & 1 & 2  & + & + & - & - \\
    bingbong   & initBricks & (dom,[int],int,int)                         & 63 & 12 & 4 & 13 & + & + & - & - \\
    bingbong   & doPaddlePower & (dom,int,int)                            &    &    &   &    &   &   &   & \\
    bingbong   & drawLevel & (dom,int,int,int,int)                        &    &    &   &    &   &   &   & \\
    bingbong   & goPing & (dom,int,int,int)                               &    &    &   &    &   &   &   & \\
    \midrule
    burncanvas & do\_draw & (int,int,int,int,int,int,int)                 & 39 & 12 & 2 & 14 & - & - & - & - \\
    \midrule
    cs-in-js   & luhn-algorithm & (string,bool)                           &    &    &   &    &   &   &   & \\
    cs-in-js   & quicksort-partition & ([int],int,int)                    &    &    &   &    &   &   &   & \\ 
    \midrule
    mathjs     & prob\_gamma & (float)                                    & 56 & 8  & 2 & 16 & - & - & - & - \\
    \bottomrule
  \end{tabular}
%}
\end{table*}

\subsection{Research Questions}
\label{sub.sec.research.questions}


\begin{description}
\item[\textbf{Q1}] What is the performance of our test generation framework?
\item[\textbf{Q2}] How does genetic version perform against the random one?
\item[\textbf{Q3}] How does the restart of genetic algorithm after the archive convergence enhance the performance? 
\end{description}

\begin{table*}
  \caption{Statistics for genetic and random algorithms}
  \label{tbl.stats}
  \resizebox{\textwidth}{!}{
    \footnotesize
    \begin{tabular}{l|rrrr|rrrr|rrrr|rrrr|r|r|r|r|r|r}
      \toprule
      \textbf{name}   & $\bar{x}_R$     & $\bar{x}_G$   & $\bar{x}_{G5}$ & $\bar{x}_{G10}$ & $m_R$       & $m_G$     & $m_{G5}$     & $m_{G10}$   & $\min_R$  & $\min_G$ & $\min_{G5}$ & $\min_{G10}$ & $\max_R$  & $\max_G$ & $\max_{G5}$ & $\max_{G10}$ & \textbf{G-R} & \textbf{G5-R} & \textbf{G10-R} & \textbf{G5-G} & \textbf{G10-G} & \textbf{G10-G5}\\
      \toprule
      helpMe          & 235.68 / 293    & 74.04 / 63.18 & 83.66 / 78.34 & 84.34 / 80.68 & 211.5 / 270 & 55.5 / 47 & 62 / 59.5   & 56.5 / 55.5 & 25 / 33   & 8 / 7    & 8 / 8      & 10 / 12     & 445 / 609 & 286 / 258 & 401 / 368  & 494 / 468 & & & & & & \\
    $(3,4,\inFor)$    & 3.94 (5.34)     & 7.94 (6.24)   & 10.22  (8.48) & 11.7 (9.32)   & 3 (4)       & 3.5 (3)   & 7 (6)       & 7 (6)       & 1 (1)     & 1 (1)    & 1 (1)      & 1 (2)       & 16 (21)   & 31 (23)   & 63 (48)    & 124 (84)  & & & & & & \\
    $(5,6,\thenBr)$   & 3.7 (5.74)      & 13.08 (9.86)  &   9.2  (7.76) & 9.6 (8.06)    & 3 (5)       & 7 (5.5)   & 5 (4)       & 5.5 (5)     & 1 (2)     & 1 (1)    & 1 (1)      & 1 (1)       & 14 (28)   & 95 (68)   & 44 (38)    & 105 (89)  & & & & & & \\
    $(5,15,\elseBr)$  & 118.64 (151.48) & 30.14 (27.08) & 34.12  (32.7) & 31.68 (31.92) & 119.5 (156) & 23 (20.5) & 28.5 (28.5) & 22 (23.5)   & 4 (6)     & 4 (3)    & 3 (3)      & 1 (2)       & 199 (294) & 97 (99)   & 167 (156)  & 114 (130) & & & & & & \\
    $(9,10,\thenBr)$  & 105.12 (124.26) & 17.82 (15.58) & 21.98 (21.66) & 21.8 (21.9)   & 83.5 (101)  & 17 (14)   & 17.5 (17)   & 18 (17)     & 18 (23)   & 1 (1)    & 2 (2)      & 6 (6)       & 199 (245) & 53 (51)   & 78 (83)    & 77  (86)  & & & & & & \\
    $(9,14,\elseBr$   & 4.28 (6.18)     & 5.06 (4.42)   &  8.14 (7.74)  & 9.56 (9.48)   & 2.5 (4)     & 5 (4)     & 4 (4)       & 4 (4)       & 1 (1)     & 1 (1)    & 1 (1)      & 1 (1)       & 17 (21)   & 20 (17)   & 49 (43)    & 74  (79)  & & & & & & \\
    \midrule
    isGameFinished      & 343.82 / 290.26 & 132.76 / 135.06 & 69.32 / 75.68 & 71.12 / 77.48 & 258 / 219.5 & 27 / 30   & 34.5 / 39   & 38 / 43   & 200 / 142 & 1 / 2   &  1 / 3    & 2 / 5       & 598 / 573 & 601 / 668 & 600 / 676  & 484 / 513 & & & & & & \\
    %% $(5,6,\inFor)$   & 0.02 (0)        & 0.1 (0.88)      & 0.12 (0.94)   & 0.1 (0.94)    & 0 (1)       & 0 (1)     & 0 (1)       & 0 (1)     & 0 (0)     & 0 (0)   & 0 (0)     & 0 (0)       & 1 (2)     & 2 (3)     & 2 (3)      & 2 (3)  \\
    $(7,8,\thenBr)$     & 75.18 (63.68)   & 40.54 (40.32)   & 18.86 (19.62) & 14.66 (15.62) & 35.5 (29.5) & 7 (7.5)   & 8 (9.5)     & 11 (12.5) & 0 (0)     & 0 (0)   & 0 (1)     & 0 (1)       & 199 (191) & 199 (225) & 199 (196)  & 82 (77) & & & & & & \\
    %% $(7,15,\elseBr)$ & 0 (0.98)        & 0.06 (0.82)     & 0.04 (0.84)   & 0.08 (0.9)    & 0 (1)       & 0 (1)     & 0 (1)       & 0 (1)     & 0 (0)     & 0 (0)   & 0 (0)     & 0 (0)       & 0 (3)     & 2 (3)     & 1 (2)      & 2 (3)  \\
    $(10,11,\thenBr)$   & 199 (166.32)    & 35.74 (36.6)    & 21.56 (22.5)  & 24.36 (26.44) & 199 (167)   & 10 (10)   & 10 (10.5)   & 9 (11)    & 199 (141) & 1 (2)   & 1 (1)     & 2 (3)       & 199 (191) & 199 (220) & 199 (217)  & 199 (224) & & & & & & \\
    $(10,14,\elseBr)$   & 69.62 (59.28)   & 56.32 (56.44)   & 28.74 (31.78) & 31.92 (33.58) & 23.5 (21)   & 10 (10.5) & 16.5 (17)   & 18 (17.5) & 1 (1)     & 0 (0)   & 0 (1)     & 0 (1)       & 199 (186) & 199 (217) & 199 (258)  & 199 (206) & & & & & & \\
    \midrule
    newGame             & 21.64 / 18.26 & 10.74 / 11.28 & 10.12 / 11.94  & 8.38 / 10.5   & 15 / 13.5   & 7.5 / 9   & 7.5 / 10    & 7 / 10   & 0 / 1      & 0 / 1    & 0 / 1      & 0 / 0       & 99 / 69  & 58 / 53    & 33 / 39    & 36 / 34  & & & & & & \\
    %% $(4,5,\inFor)$   & 0.04 (0.9)    & 0.12 (0.66)   & 0.1 (0.84)     & 0 (0.86)      & 0 (1)       & 0 (1)     & 0 (1)       & 0 (1)     & 0 (0)     & 0 (0)    & 0 (0)      & 0 (0)       & 1 (2)    & 2 (2)      & 1 (2)      & 0 (1) \\
    $(6,7,\thenBr)$     & 21.54 (16.58) & 10.48 (9.78)  & 9.92 (10.24)   & 8.34 (8.84)   & 15 (11.5)   & 7.5 (7)   & 7.5 (8)     & 7 (8)     & 0 (1)     & 0 (1)    & 0 (1)      & 0 (0)       & 97 (67)  & 53 (47)    & 30 (34)    & 35 (31) & & & & & & \\
    %% $(6,12,\elseBr)$ & 0.06 (0.78)   & 0.14 (0.84)   & 0.1 (0.86)     & 0.04 (0.8)    & 0 (1)       & 0 (1)     & 0 (1)       & 0 (1)     & 0 (0)     & 0 (0)    & 0 (0)      & 0 (0)       & 1 (2)    & 3 (4)      & 2 (3)      & 1 (2) \\
    \midrule
    revealAll           & 77.9 / 69.2   & 51.06 / 55.26 & 65.04 / 70.34 & 55.68 / 64.04 & 58 / 50     & 42 / 44   & 55.5 / 58.5 & 44.5 / 52.5 & 9 / 8     & 16 / 16  & 16 / 16    & 16 / 16     & 305 / 261 & 135 / 153  & 200 / 226  & 165 / 202 & & & & & &\\
    $(2,3,\inFor)$      & 31.78 (27.78) & 24.84 (26.7)  & 34.94 (39.34) & 28.04 (32.58) & 24 (20)     & 23 (24)   & 29 (30.5)   & 22.5 (27)   & 4 (3)     & 7 (7)    & 7 (7)      & 10 (11)     & 106 (89)  & 57 (64)    & 129 (148)  & 75 (100)  & & & & & & \\
    $(4,5,\inFor)$      & 46.12 (41.42) & 26.22 (28.56) & 30.1 (33.02)  & 27.64 (31.46) & 34 (30)     & 19 (20)   & 26.5 (28)   & 22 (25.5)   & 5 (5)     & 9 (9)    & 9 (9)      & 6 (5)       & 199 (172) & 78 (89)    & 71 (78)    & 90 (102)  & & & & & & \\
    \midrule
    shuffleBoard         & 211.4 / 410.56 & 218.88 / 321.28 & 224.92 / 371.58 & 222.26 / 358.84 & 206.5 / 401.5 & 207 / 299   & 212.5 / 338 & 209 / 321 & 199 / 342 & 199 / 250 & 199 / 268 & 199 / 263 & 258 / 568 & 402 / 689 & 351 / 716 & 360 / 674 & & & & & & \\
    %% $(3,4,\inFor)$    & 0 (1.6)        & 0 (1.36)        & 0 (1.52)        & 0 (1.42)        & 0 (2)         & 0 (1)       & 0 (2)       & 0 (1)     & 0 (1)     & 0 (1)     & 0 (1)     & 0 (1)     & 0 (3)     & 0 (2)     & 0 (2)     & 0 (2 )    & & & & & & \\
    %% $(5,6,\inWhile)$  & 0.36 (2.94)    & 0.32 (2.6)      & 0.24 (2.58)     & 0.38 (2.88)     & 0 (2)         & 0 (2)       & 0 (2)       & 0 (2)     & 0 (1)     & 0 (1)     & 0 (1)     & 0 (1)     & 4 (11)    & 3 (8)     & 2 (6)     & 5 (15)    & & & & & & \\
    %% $(10,11,\inFor)$  & 0 (1.88)       & 0 (1.4)         & 0 (1.64)        & 0 (1.58)        & 0 (2)         & 0 (1)       & 0 (2)       & 0 (2)     & 0 (2)     & 0 (1)     & 0 (1)     & 0 (1)     & 0 (3)     & 0 (2)     & 0 (2)     & 0 (2)     & & & & & & \\
    $(13,14,\thenBr)$    & 6.38 (13.6)    & 7.7 (13.88)     & 8.72 (17.7)     & 7.86 (15.78)    & 4 (9.5)       & 4 (8.5)     & 4 (8.5)     & 5 (9.5)   & 0 (1)     & 0 (1)     & 0 (1)     & 0 (1)     & 22 (44)   & 67 (103)  & 64 (126)  & 38 (78)   & & & & & & \\
    % $(13,16,\elseBr)$  & 0 (1.52)       & 0 (1.4)         & 0 (1.68)        & 0 (1.5)         & 0 (1.5)       & 0 (1)       & 0 (2)       & 0 (1.5)   & 0 (1)     & 0 (1)     & 0 (1)     & 0 (1)     & 0 (3)     & 0 (2)     & 0 (2)     & 0 (2)     & & & & & & \\
    $(17,18,\thenBr)$    & 5.66 (13.76)   & 11.86 (23.7)    & 16.96 (39.58)   & 15.02 (34.04)   & 3.5 (10)      & 4 (10)      & 5.5 (12.5)  & 5 (1)     & 0 (1)     & 0 (2)     & 0 (2)     & 0 (2)     & 33 (73)   & 133 (248) & 86 (180)  & 118 (248) & & & & & & \\
    %% $(17,20,\elseBr)$ & 0 (2.06)       & 0 (1.84)        & 0 (1.72)        & 0 (1.8)         & 0 (2)         & 0 (2)       & 0 (2)       & 0 (2)     & 0 (1)     & 0 (1)     & 0 (1)     & 0 (1)     &  0 (4)    & 0 (2)     & 0 (2)     & 0 (2)     & & & & & & \\
    %% $(21,22,\inFor)$  & 199 (373.2)    & 199 (275.1)     & 199 (305.16)    & 199 (299.84)    & 199 (372.5)   & 199 (273.5) & 199 (307)   & 199 (302) & 199 (334) & 199 (242) & 199 (260) & 199 (255) & 199 (427) & 199 (322) & 199 (396) & 199 (325) & & & & & & \\
    \midrule
    \midrule
    toggleInfo         & 3.06 / 6.12 & 11.02 / 11.9 & 18.1 / 18.3 & 16.3 / 15.4  & 2 / 5.5 & 3 / 7 & 5  7.5  & 5 / 6 & 0 / 0 & 0 / 0 & 0 / 0 & 0 / 0 & 19 / 22 & 129 / 118 & 146 / 138 & 139 / 106 & & & & & & \\
    $(2,3,\thenBr)$    & 1.58 (2.32) & 1.12 (1.64)  & 1.1 (1.7)   & 1 (1.46)     & 1 (1.5) & 1 (2) & 1 (2)   & 1 (1) & 0 (0) & 0 (0) & 0 (0) & 0 (0) & 11 (11) & 4 (4)     & 3 (4)     & 3 (3)     & & & & & & \\
    %% $(2,5,\elseBr)$ & 0 (0.86)    & 0 (0.84)     & 0 (0.86)    & 0 (0.8)      & 0 (1)   & 0 (1) & 0 (1)   & 0 (1) & 0 (0) & 0 (0) & 0 (0) & 0 (0) & 0 (2)   & 0 (1)     & 0 (1)     & 0 (1)     & & & & & & \\
    $(6,7,\thenBr)$    & 1.48 (2.1)  & 9.9 (8.7)    & 17 (14.92)  & 15.3 (12.34) & 1 (2)   & 2 (3) & 4 (3.5) & 4 (3) & 0 (0) & 0 (0) & 0 (0) & 0 (0) & 8 (8)   & 125 (112) & 143 (132) & 136 (101) & & & & & & \\
    %% $(6,13,\elseBr)$& 0 (0.84)    & 0 (0.72)     &  0 (0.82)   & 0 (0.8)      & 0 (1)   & 0 (1) & 0 (1)   & 0 (1) & 0 (0) & 0 (0) & 0 (0) & 0 (0) & 0 (1)   & 0 (1)     & 0 (1)     & 0 (1)     & & & & & & \\
    \midrule
    \midrule
    isValidCard       & 995 / 513.66 & 14.76 / 7.8 & 14.8 / 7.96 & 14.82 / 8.42 & 995 / 514   & 15 / 8 & 15 / 7 & 15 / 9.5 & 995 / 447 & 10 / 5 & 10 / 5 & 10 / 5 & 995 / 579 & 22 / 12 & 24 / 13 & 24 / 12  & & & & & & \\ 
    $(3,4,\thenBr)$   & 0 (0.54)     & 0 (0.3)     & 0 (0.46)    & 0 (0.46)     & 0 (1)       & 0 (0)  & 0 (0)  & 0 (0)    & 0 (0)     & 0 (0)  & 0 (0)  & 0 (0)  & 0 (0)     & 0 (1)   & 0 (1)   & 0 (0)    & & & & & & \\
    $(3,6,\elseBr)$   & 199 (102.98) & 2.98 (1.52) & 3 (1.4)     & 2.82 (1.56)  & 199 (102.5) & 3 (2)  & 3 (1)  & 3 (2)    & 199 (87)  & 2 (1)  & 2 (1)  & 2 (1)  & 199 (116) & 5 (2)   & 5 (3)   & 4 (3)    & & & & & & \\
    $(7,8,\inFor)$    & 199 (102.38) & 2.92 (1.44) & 3.04 (1.6)  & 2.96 (1.58)  & 199 (103)   & 3 (1)  & 3 (2)  & 3 (2)    & 199 (90)  & 2 (1)  & 2 (1)  & 2 (1)  & 199 (115) & 5 (3)   & 4 (2)   & 5 (2)    & & & & & & \\
    $(10,11,\thenBr)$ & 199 (101.44) & 3 (1.56)    & 2.86 (1.48) & 3.06 (1.7)   & 199 (102)   & 3 (2)  & 3 (1)  & 3 (2)    & 199 (88)  & 2 (1)  & 2 (1)  & 2 (1)  & 199 (116) & 4 (2)   & 5 (2)   & 5 (3)    & & & & & & \\
    $(10,13,\elseBr)$ & 199 (104.66) & 2.84 (1.38) & 2.98 (1.54) & 3.04 (1.62)  & 199 (106)   & 3 (1)  & 3 (2)  & 3 (2)    & 199 (91)  & 2 (1)  & 2 (1)  & 2 (1)  & 199 (115) & 4 (2)   & 5 (2)   & 5 (2)    & & & & & & \\
    $(14,15,\inFor)$  & 199 (101.66) & 3.02 (1.6)  & 2.92 (1.48) & 2.94 (1.5)   & 199 (99.5)  & 3 (2)  & 3 (1)  & 3 (1.5)  & 199 (91)  & 2 (1)  & 2 (1)  & 2 (1)  & 199 (117) & 4 (2)   & 5 (3)   & 5 (2)    & & & & & & \\
    \midrule
    isValidMasterCard  & 199 / 109.46 & 11.04 / 4.84 & 12.08 / 5.1  & 11.42 / 5.03 & 199 / 102.5 & 10 / 4 & 12 / 4.5 & 10 / 4 & 199 / 86 & 4 / 2 & 5 / 2 & 5 / 2 & 199 / 164 & 27 / 11 & 32 / 11 & 23 / 10 & & & & & & \\
    $(2,3,\thenBr)$    & 199 (108.98) & 11.04 (4.5)  & 12.08 (4.64) & 11.42 (4.6)  & 199 (102.5) & 10 (4) & 12 (4.5) & 10 (4) & 199 (86) & 4 (2) & 5 (2) & 5 (2) & 199 (162) & 27 (10) & 32 (10) & 23 (9)  & & & & & & \\
    %% $(2,5,\elseBr)$ & 0 (0.48)     & 0 (0.34)     & 0 (0.46)     & 0 (0.43)     & 0 (0)       & 0 (0)  & 0 (0)    & 0 (0)  & 0 (0)    & 0 (0) & 0 (0) & 0 (0) & 0 (2)     & 0 (1)   & 0 (1)   & 0 (1)   & & & & & & \\    

    %% isValidVISA     & 199 / 97.54 & 6.54 / 3.06 & 6.38 / 3.04 & 6.48 / 3.04 & 199 / 95 & 6 / 3 & 6 / 3 & 6 / 2 & 199 / 89 & 4 /2  & 3 / 1 & 4 / 1 & 199 / 140 & 14 / 6 & 16 / 7 & 18 / 7 & & & & & & \\\\
    %% $(2,3,\thenBr)$ & 199 (97.08) & 6.54 (2.72) & 6.38 (2.62) & 6.48 (2.58) & 199 (95) & 6 (3) & 6 (3) & 6 (2) & 199 (89) & 4 (2) & 3 (1) & 4 (1) & 199 (139) & 14 (5) & 16 (6) & 18 (6) & & & & & & \\ \\
    %% $(2,5,\elseBr)$ & 0 (0.46)    & 0 (0.34)    & 0 (0.42)    & 0 (0.46)    & 0 (0)    & 0 (0) & 0 (0) & 0 (0) & 0 (0)    & 0 (0) & 0 (0) & 0 (0) & 0 (1)     & 0 (1)  & 0 (1)  & 0 (1)  & & & & & & \\  \\
    \midrule
    \midrule
    initShields       & 5 / 5.8 & 5.32 / 3.76 & 5.28 / 3.9 & 5.26 / 3.7 & 5 / 5 & 5 / 4 & 5 / 4 & 5 / 3 & 5 / 3 & 5 / 3 & 5 / 3 & 5 / 3 & 5 / 10 & 6 / 5 & 7 / 5 & 7 / 5 & & & & & & \\
    $(2,3,\inFor)$    & 5 (5.8) & 5.32 (3.76) & 5.28 (3.9) & 5.26 (3.7) & 5 (5) & 5 (4) & 5 (4) & 5 (3) & 5 (3) & 5 (3) & 5 (3) & 5 (3) & 5 (10) & 6 (5) & 7 (5) & 7 (5) & & & & & & \\
    \midrule
    \midrule
    brickJiggler      & 5.22 / 9.74 & 5.34 / 4.68 & 5.68 / 4.98 & 5.3 / 4.28 & 5 / 8 & 4 / 4 & 8 / 4 & 2 / 3 & 1 / 2 & 2 / 3 & 1 / 2 & 1 / 2 & 18 / 28 & 39 / 20 & 20 / 12 & 20 / 12 & & & & & &\\
    $(2,3,\thenBr)$   & 5.22 (8.46) & 5.34 (3.54) & 5.68 (3.66) & 5.3 (3.2)  & 5 (7) & 4 (3) & 4 (3) & 2 (2) & 1 (2) & 2 (2) & 1 (1) & 1 (1) & 18 (25) & 39 (18) & 20 (10) & 20 (10) & & & & & & \\
    %% $(2,9,\elseBr)$& 0 (1.28)    & 0 (1.14)    & 0 (1.32)    & 0 (1.08)   & 0 (1) & 0 (1) & 4 (1) & 0 (1) & 0 (0) & 0 (1) & 0 (1) & 0 (1) & 0 (3)   & 0 (2)   & 0 (2)   & 0 (2)   & & & & & & \\
    \midrule
    doPaddlePower        & 18.1 / 17.64  & 193.54 / 134.54 & 47.32 / 36.4  & 42.78 / 29.58 & 14.5 / 15 & 199 / 140 & 17 / 14 & 21 / 16 & 1 / 1 & 3 / 3 & 0 / 0 & 0 / 1 & 54 / 51 & 204 / 160 & 202 / 157 & 204 / 144 & & & & & & \\
    %% $(5,6,\thenBr)$   & 0 (0.82)      & 0 (0.82)        & 0 (0.9)       & 0 (0.86)      & 0 (1)     & 0 (1)     & 0 (1)   & 0 (1)   & 0 (0) & 0 (0) & 0 (0) & 0 0   & 0 (2)   & 0 (1)     & 0 (1)     & 0 (1)     & & & & & & \\
    %% $(5,8,\elseBr)$   & 0.14 (0.9)    & 0.4 (1.04)      & 0.14 (0.82)   & 0.28 (0.74)   & 0 (1)     & 0 (1)     & 0 (1)   & 0 (1)   & 0 (0) & 0 (0) & 0 (0) & 0 0   & 1 (3)   & 5 (4)     & 3 (2)     & 5 (3)     & & & & & & \\
    $(10,11,\thenBr)$    & 17.96 (15.04) & 193.14 (131.86) & 47.18 (33.86) & 42.5 (27.24)  & 14.5 (12) & 199 (136) & 17 (12) & 21 (13) & 0 (1) & 3 (3) & 0 (0) & 0 (1) & 53 (43) & 199 (154) & 199 (153) & 199 (139) & & & & & & \\
    %% $(10,13,\elseBr)$ & 0 (0.88)      & 0 (0.82)        & 0 (0.82)      & 0 (0.74)      & 0 (1)     & 0 (1)     & 0 (1)   & 0 (1)   & 0 (0) & 0 (0) & 0 (0) & 0 0   & 0 (3)  & 0 (1)     & 0 (1)     & 0 (1)     & & & & & & \\    
    
    %% drawLevel         & 1.06 / 6.78 & 2.14 / 6.05 & 2.06 / 6.92 & 1.86 / 5.82 & 0 / 6 & 0 / 6 & 0 / 6 & 0 / 6 & 0 / 0 & 0 / 0 & 0 / 0 & 0 / 0 & 10 / 17 & 25 / 19 & 28 / 23 & 27 / 19 & & & & & \\
    %% $(5,6,\thenBr)$   & 0.18 (1.04) & 0.16 (0.9)  & 0.14 (1.04) & 0.2 (0.9)   & 0 (1) & 0 (1) & 0 (1) & 0 (1) & 0 (0) & 0 (0) & 0 (0) & 0 (0) & 2 (2)   & 3 (2)   & 5 (4)   & 5 (3) & & & & & & \\
    %% $(5,21,\elseBr)$  & 0 (0.86)    & 0 (0.9)     & 0 (0.92)    & 0 (0.84)    & 0 (1) & 0 (1) & 0 (1) & 0 (1) & 0 (0) & 0 (0) & 0 (0) & 0 (0) & 0 (2)   & 0 (2)   & 0 (1)   & 0 (1) & & & & & & \\
    %% $(8,9,\inFor)$    & 0.1 (1.04)  & 0.16 (0.89) & 0.34 (1.1)  & 0.3 (1.06)  & 0 (1) & 0 (1) & 0 (1) & 0 (1) & 0 (0) & 0 (0) & 0 (0) & 0 (0) & 3 (4)   & 5 (3)   & 5 (4)   & 5 (4) & & & & & & \\
    %% $(10,11,\thenBr)$ & 0.64 (1.52) & 1.26 (1.48) & 0.98 (1.62) & 0.8 (1.1)   & 0 (1) & 0 (1) & 0 (1) & 0 (1) & 0 (0) & 0 (0) & 0 (0) & 0 (0) & 3 (5)   & 7 (5)   & 7 (6)   & 8 (5) & & & & & & \\
    %% $(10,13,\elseBr)$ & 0.06 (1.2)  & 0.22 (0.86) & 0.3 (1.14)  & 0.2 (0.98)  & 0 (1) & 0 (1) & 0 (1) & 0 (1) & 0 (0) & 0 (0) & 0 (0) & 0 (0) & 1 (3)   & 3 (2)   & 7 (4)   & 3 (2) & & & & & & \\
    %% $(14,15,\inFor)$  & 0.08 (1.12) & 0.34 (1.02) & 0.3 (1.1)   & 0.36 (0.94) & 0 (1) & 0 (1) & 0 (1) & 0 (1) & 0 (0) & 0 (0) & 0 (0) & 0 (0) & 1 (1)   & 7 (5)   & 4 (4)   & 6 (4) & & & & & & \\
    \midrule
    initBricks        & 1285.42/ 2272.40  & 637.06 / 579.58 & 594.36 / 617    & 587.80 / 584.06 & 1397.50 / 2379  & 568  / 474  & 470.5 / 517   & 402.5 / 374.5 & 42 / 90  & 42 / 60 & 44 / 64 & 38 / 59 & 2413 / 4647 & 1596 / 1612 & 1623 / 1731 & 1609 / 1653 & & & & & & \\
    $(6,7,\thenBr)$   & 1.5    / 3.94     & 3      / 3.6    & 2.6    / 3.54   & 2.74   / 3.6    & 1       / 3     & 4    / 4    & 2     / 3     & 2     / 3     & 1  / 2   & 1  / 2  & 1  / 1  & 1  / 2  & 5    / 9    & 5    / 5    & 5    / 5    & 5    / 5    & & & & & & \\
    $(6,10,\elseBr)$  & 29.82  / 50.56    & 5.98   / 6.16   & 5.28   / 6.32   & 7.1    / 7.68   & 13.5    / 23    & 5    / 6    & 5     / 6     & 5     / 6     & 1  / 3   & 1  / 2  & 1  / 2  & 1  / 3  & 199  / 370  & 14   / 10   & 13   / 14   & 24   / 23   & & & & & & \\
    $(11,12,\thenBr)$ & 162.28 / 267.92   & 18.36  / 16.22  & 27.58  / 27.02  & 25.26  / 23.98  & 199     / 317   & 13   / 11.5 & 16.5  / 16.5  & 16    / 15    & 2  / 5   & 5  / 6  & 4  / 6  & 4  / 5  & 199  / 366  & 56   / 48   & 71   / 67   & 77   / 78   & & & & & & \\
    $(11,15,\elseBr)$ & 32.44  / 54.7     & 5.9    / 6.32   & 6.02   / 6.84   & 8.1    / 8.52   & 17      / 30    & 5    / 6    & 6     / 7     & 5     / 6     & 1  / 3   & 1  / 3  & 1  / 2  & 1  / 2  & 199  / 314  & 16   / 13   & 28   / 28   & 55   / 53   & & & & & & \\
    $(16,17,\thenBr)$ & 164.06 / 272.82   & 25.14  / 23.36  & 37.48  / 38.68  & 28.64  / 28.08  & 199     / 324   & 16   / 13.5 & 12.5  / 13    & 16    / 16    & 4  / 9   & 4  / 5  & 1  / 2  & 2  / 3  & 199  / 379  & 199  / 187  & 199  / 205  & 112  / 109  & & & & & & \\
    $(16,20,\elseBr)$ & 57.22  / 95.9     & 8.32   / 8.16   & 12.2   / 13.3   & 10.92  / 11.06  & 23.5    / 40    & 6    / 6.5  & 5     / 6     & 7     / 7     & 1  / 3   & 1  / 3  & 1  / 2  & 1  / 3  & 199  / 367  & 62   / 50   & 68   / 70   & 86   / 83   & & & & & & \\
    $(21,22,\thenBr)$ & 152.56 / 251.98   & 19.38  / 19.38  & 30.92  / 32.16  & 40.12  / 40.48  & 199     / 309.5 & 13   / 12.5 & 12.5  / 13.5  & 16    / 16.5  & 1  / 3   & 1  / 2  & 2  / 4  & 2  / 3  & 199  / 370  & 199  / 181  & 117  / 121  & 149  / 151  & & & & & & \\
    $(21,25,\elseBr)$ & 56.34  / 93.62    & 6.88   / 7.08   & 11.56  / 12.72  & 12.82  / 13.12  & 24.5    / 41    & 6    / 6.5  & 6     / 7     & 6.5   / 7     & 2  / 5   & 2  / 3  & 1  / 3  & 1  / 3  & 199  / 371  & 22   / 20   & 91   / 99   & 80   / 81   & & & & & & \\
    $(29,30,\thenBr)$ & 147.66 / 275.06   & 102.66 / 90.36  & 91     / 88.74  & 96.48  / 88.92  & 199     / 330   & 65   / 57.5 & 69.5  / 69.5  & 73    / 70    & 2  / 5   & 5  / 5  & 5  / 6  & 5  / 5  & 199  / 413  & 199  / 208  & 199  / 204  & 199  / 201  & & & & & & \\
    $(29,37,\elseBr)$ & 1.46   / 4.44     & 2.5    / 3.76   & 2.52   / 4      & 2.78   / 4.04   & 1       / 4     & 2    / 3    & 2     / 4     & 2     / 4     & 1  / 3   & 1  / 2  & 1  / 2  & 1  / 2  & 5    / 11   & 6    / 7    & 5    / 6    & 5    / 6    & & & & & & \\
    $(38,39,\thenBr)$ & 145.72 / 266.76   & 108.1  / 93.96  & 94.46  / 95.88  & 89.2   / 86.26  & 184     / 328   & 84   / 66.5 & 74.5  / 82    & 46.5  / 4     & 16 / 30  & 4  / 5  & 11 / 11 & 4  / 5  & 199  / 410  & 199  / 208  & 199  / 217  & 199  / 214  & & & & & & \\
    $(38,46,\elseBr)$ & 1.42   / 4.32     & 2.5    / 3.66   & 2.7    / 4.3    & 2.5    / 3.92   & 1       / 4     & 2    / 3.5  & 2     / 4     & 2     / 4     & 1  / 2   & 1  / 2  & 1  / 2  & 1  / 2  & 3    / 8    & 6    / 6    & 6    / 8    & 5    / 6    & & & & & & \\
    $(47,48,\thenBr)$ & 141.5  / 264.56   & 121    / 108.44 & 112.16 / 115.74 & 108.1  / 108.1  & 185.5   / 335.5 & 199  / 141  & 118   / 128   & 125.5 / 131   & 2  / 5   & 5  / 6  & 5  / 6  & 6  / 7  & 199  / 408  & 199  / 212  & 199  / 227  & 199  / 206  & & & & & & \\
    $(47,55,\elseBr)$ & 1.54   / 4.52     & 2.44   / 3.74   & 2.5    / 4      & 2.46   / 3.92   & 1       / 4     & 2    / 3    & 2     / 4     & 2     / 4     & 1  / 2   & 1  / 2  & 1  / 2  & 1  / 2  & 4    / 9    & 5    / 6    & 5    / 6    & 5    / 6    & & & & & & \\
    $(56,57,\thenBr)$ & 111.98 / 208.04   & 96.62  / 86.78  & 94.8   / 98.74  & 90.16  / 89.54  & 108     / 197.5 & 48.5 / 42.5 & 113   / 123.5 & 48    / 47    & 3  / 6   & 5  / 5  & 5  / 6  & 4  / 5  & 199  / 411  & 199  / 222  & 199  / 213  & 199  / 209  & & & & & & \\
    $(56,64,\elseBr)$ & 1.52   / 4.48     & 2.66   / 3.82   & 2.96   / 4.38   & 2.48   / 3.94   & 1       / 4     & 2    / 3    & 2     / 4     & 2     / 4     & 1  / 2   & 1  / 2  & 1  / 2  & 1  / 2  & 5    / 7    & 5    / 5    & 13   / 15   & 5    / 6    & & & & & & \\
    $(69,70,\thenBr)$ & 1.42   / 4.26     & 2.64   / 2.64   & 2.8    / 4.72   & 2.52   / 4.26   & 1       / 4     & 2    / 4    & 2     / 4     & 2     / 4     & 1  / 2   & 1  / 2  & 1  / 2  & 1  / 2  & 3    / 8    & 6    / 7    & 7    / 9    & 6    / 8    & & & & & & \\
    $(69,71,\elseBr)$ & 74.98  / 144.52   & 102.98 / 92.14  & 54.82  / 55.92  & 55.42  / 54.64  & 39.5    / 80.5  & 93.5 / 83.5 & 20    / 22    & 26    / 26    & 1  / 3   & 2  / 3  & 1  / 3  & 1  / 3  & 199  / 416  & 199  / 217  & 199  / 217  & 199  / 208  & & & & & & \\
    \midrule
    \midrule
    do\_draw             & 266.40 / 695.56 & 295.52 / 1064.82 & 99.22 / 346.64 & 105.44 / 347.42 & 245.5 / 625   & 362   / 1295  & 89   / 315  & 101.5 / 333.5  & 9 / 49 & 7 / 49 & 6 / 47 & 6 / 46 & 685 / 1772 & 505 / 1855 & 424 / 1453 & 332 / 1077 & & & & & & \\
    %% $(2,3,\thenBr)$   & 0      / 2.42   & 0      / 2.48    & 0     / 2.44   & 0      / 2.38   & 0     / 2     & 0     / 2     & 0    / 2    & 0     / 2      & 0 / 2  & 0 / 2  & 0 / 2  & 0 / 2  & 0   / 3    & 0   / 4    & 0   / 3    & 0   / 3    & & & & & & \\
    %% $(2,5,\elseBr)$   & 0      / 0.98   & 0      / 0.98    & 0     / 0.98   & 0      / 0.94   & 6     / 1     & 0     / 1     & 0    / 1    & 0     / 1      & 0 / 0  & 0 / 0  & 0 / 0  & 0 / 0  & 0   / 1    & 0   / 2    & 0   / 2    & 0   / 1    & & & & & & \\
    $(6,7,\thenBr)$      & 8.88   / 23.62  & 6.72   / 23.74   & 6.4   / 21.66  & 5.84   / 19.82  & 6.5   / 18.5  & 7     / 25    & 7    / 23   & 6     / 20     & 0 / 2  & 0 / 2  & 0 / 2  & 0 / 2  & 43  / 103  & 13  / 46   & 16  / 50   & 14  / 15   & & & & & & \\
    $(6,12,\elseBr)$     & 0      / 1.02   & 0      / 1       & 0     / 0.94   & 0      / 0.94   & 0     / 1     & 0     / 1     & 0    / 1    & 0     / 1      & 0 / 0  & 0 / 0  & 0 / 0  & 0 / 0  & 0   / 2    & 0   / 2    & 0   / 1    & 0   / 2    & & & & & & \\
    %% $(8,9,\thenBr)$   & 12.58  / 32.2   & 5.56   / 19.58   & 5.88  / 20.12  & 5.62   / 19.3   & 9     / 23    & 5     / 17    & 6    / 20   & 6     / 20.5   & 0 / 2  & 0 / 2  & 0 / 2  & 0 / 0  & 53  / 124  & 17  / 54   & 14  / 45   & 15  / 47   & & & & & &\\
    $(8,11,\elseBr)$     & 131.86 / 318.68 & 18.78  / 62.16   & 24.16 / 77.08  & 19.34  / 61.76  & 143   / 343   & 15.5  / 51    & 22   / 70.5 & 18    / 57     & 6 / 16 & 4 / 15 & 6 / 20 & 0 / 2  & 199 / 488  & 65  / 214  & 53  / 165  & 46  / 146  & & & & & &\\
    %% $(20,21,\thenBr)$ & 0      / 1.2    & 0      / 1.44    & 0     / 1.22   & 0      / 1.22   & 0     / 1     & 0     / 1     & 0    / 1    & 0     / 1      & 0 / 1  & 0 / 1  & 0 / 1  & 5 / 18 & 0   / 2    & 0   / 3    & 0   / 2    & 0   / 2    & & & & & &\\
    %% $(20,23,\elseBr)$ & 0      / 2.52   & 0      / 2.58    & 0     / 2.46   & 0      / 2.46   & 0     / 3     & 0     / 2.5   & 0    / 2    & 0     / 2      & 0 / 2  & 0 / 2  & 0 / 2  & 0 / 1  & 0   / 3    & 0   / 4    & 0   / 3    & 0   / 3    & & & & & &\\
    %% $(24,25,\thenBr)$ & 0      / 1.28   & 0      / 1.3     & 0     / 1.2    & 0      / 1.22   & 0     / 1     & 0     / 1     & 0    / 1    & 0     / 1      & 0 / 1  & 0 / 1  & 0 / 0  & 0 / 2  & 0   / 2    & 0   / 3    & 0   / 2    & 0   / 2    & & & & & &\\
    %% $(24,27,\elseBr)$ & 0.02   / 2.52   & 0.08   / 2.94    & 0.18  / 3.02   & 0.06   / 2.66   & 0     / 2.5   & 0     / 3     & 0    / 3    & 0     / 2.5    & 0 / 2  & 0 / 2  & 0 / 2  & 0 / 1  & 1   / 4    & 3   / 12   & 5   / 17   & 3   / 11   \\
    %% $(28,29,\thenBr)$ & 0      / 1.84   & 0      / 1.84    & 0     / 1.92   & 0      / 1.84   & 0     / 2     & 0     / 2     & 0    / 2    & 0     / 2      & 0 / 1  & 0 / 1  & 0 / 1  & 0 / 2  & 0   / 2    & 0   / 3    & 0   / 3    & 0   / 2    & & & & & &\\
    %% $(28,31,\elseBr)$ & 0      / 1.94   & 0      / 1.94    & 0     / 1.9    & 0      / 1.94   & 0     / 2     & 0     / 2     & 0    / 2    & 0     / 2      & 0 / 1  & 0 / 1  & 0 / 1  & 0 / 1  & 0   / 3    & 0   / 3    & 0   / 3    & 0   / 3    & & & & & &\\
    %% $(32,33,\thenBr)$ & 0      / 1.92   & 0      / 2.08    & 0     / 1.92   & 0      / 1.92   & 0     / 2     & 0     / 2     & 0    / 2    & 0     / 2      & 0 / 1  & 0 / 1  & 0 / 1  & 0 / 1  & 0   / 2    & 0   / 3    & 0   / 3    & 0   / 2    & & & & & &\\
    %% $(32,35,\elseBr)$ & 0      / 1.9    & 0      / 2.04    & 0     / 1.9    & 0      / 1.86   & 0     / 2     & 0     / 2     & 0    / 2    & 0     / 2      & 0 / 1  & 0 / 1  & 0 / 1  & 0 / 1  & 0   / 3    & 0   / 3    & 0   / 3    & 0   / 2    & & & & & &\\
    %% $(36,37,\thenBr)$ & 0      / 1.02   & 0      / 1.22    & 0     / 1      & 0      / 1.08   & 0     / 1     & 0     / 1     & 0    / 1    & 0     / 1      & 0 / 0  & 0 / 0  & 0 / 0  & 0 / 0  & 0   / 2    & 0   / 3    & 0   / 2    & 0   / 2    & & & & & &\\
    %% $(36,39,\elseBr)$ & 0.32   / 3.4    & 0.7    / 4.8     & 0.52  / 4.14   & 0.12   / 2.98   & 0     / 3     & 0     / 3     & 0    / 3    & 0     / 3      & 0 / 2  & 0 / 2  & 0 / 2  & 0 / 2  & 4   / 12   & 7   / 24   & 7   / 24   & 2   / 8    \\
    %% $(40,41,\thenBr)$ & 0      / 1.18   & 0      / 1.28    & 0     / 1.24   & 0      / 1.04   & 0     / 1     & 0     / 1     & 0    / 1    & 0     / 1      & 0 / 0  & 0 / 0  & 0 / 1  & 0 / 0  & 0   / 2    & 0   / 2    & 0   / 2    & 0   / 2    & & & & & &\\
    %% $(40,43,\elseBr)$ & 0.1    / 2.86   & 0.1    / 3.04    & 0.52  / 4.12   & 0.34   / 3.76   & 0     / 3     & 0     / 3     & 0    / 3    & 0     / 3      & 0 / 2  & 0 / 2  & 0 / 2  & 0 / 2  & 1   / 5    & 2   / 9    & 6   / 20   & 12  / 40   \\
    $(44,45,\thenBr)$    & 76.1   / 193.84 & 149.16 / 515.7   & 32.14 / 102.5  & 42.8   / 125.62 & 56    / 143.5 & 199   / 681   & 26.5 / 83   & 38.5  / 111    & 3 / 10 & 3 / 12 & 0 / 3  & 1 / 6  & 199 / 518  & 199 / 718  & 199 / 657  & 199 / 645  & & & & & & \\
    %% $(44,47,\elseBr)$ & 0      / 1.08   & 0      / 1.1     & 0     / 1.02   & 0      / 1.02   & 0     / 1     & 0     / 1     & 0    / 1    & 0     / 1      & 0 / 0  & 0 / 0  & 0 / 1  & 0 / 0  & 0   / 2    & 0   / 2    & 0   / 2    & 0   / 2    & & & & & & \\
    $(48,49,\thenBr)$    & 36.6   / 97.12  & 114.42 / 410.58  & 29.42 / 92.86  & 31.32  / 90.58  & 25    / 68    & 135.5 / 491.5 & 27.5 / 90   & 33    / 96.5   & 0 / 3  & 0 / 2  & 0 / 3  & 0 / 3  & 185 / 487  & 199 / 739  & 124 / 442  & 41  / 135  & & & & & & \\
    %% $(48,51,\elseBr)$ & 0      / 1.02   & 0      / 1       & 0     / 1      & 0      / 1.08   & 0     / 1     & 0     / 1     & 0    / 1    & 0     / 1      & 0 / 0  & 0 / 0  & 0 / 0  & 0 / 0  & 0   / 2    &  0  / 2    & 0   / 2    & 0   / 2    & & & & & & \\
    \midrule
    \midrule
    prob\_gamma          & 1982.78 / 701.78 & 148.22 / 84.88 & 138.92 / 82.56 & 149.88 / 81.98 & 1990 / 710  & 147 / 84 & 145 / 79.5  & 146 / 80.5 & 1641 / 484 & 107 / 55  & 109 / 52 & 113 / 52  & 1990 / 799 & 195 / 119 & 207 / 121 & 215 / 122 & & & & & & \\
    $(4,5,\thenBr)$      & 195.58 / 69.06   & 1.02   / 0.84  & 1      / 0.84  & 1.06   / 0.9   & 199  / 70.5 & 1   / 1  & 1   / 1     & 1   / 1    & 28   / 11  & 1   / 0   & 1   / 0  & 1   / 0   & 199  / 80  & 2   / 2   & 2   / 1   & 2   / 2   & & & & & & \\
    %% $(4,25,\elseBr)$  & 0      / 0.3     & 0      / 0.4   & 1      / 0.4   & 0      / 0.36  & 0    / 0    & 0   / 0  & 0   / 0     & 0   / 0    & 0    / 0   & 0   / 0   & 0   / 0  & 0   / 0   & 0    / 1   & 0   / 1   & 0   / 1   & 0   / 1   & & & & & & \\
    $(6,7,\thenBr)$      & 195.2  / 68.26   & 1.14   / 0.9   & 1.24   / 0.9   & 1.28   / 0.88  & 199  / 71   & 1   / 1  & 1   / 1     & 1   / 1    & 21   / 8   & 1   / 0   & 1   / 0  & 1   / 0   & 199  / 77  & 3   / 2   & 2   / 2   & 4   / 2   & & & & & & \\
    $(6,9,\elseBr)$      & 199    / 69.2    & 1.42   / 1     & 1.34   / 0.92  & 1.46   / 0.98  & 199  / 69.5 & 1   / 1  & 1   / 1     & 1   / 1    & 199  / 57  & 1   / 0   & 1   / 0  & 1   / 0   & 199  / 76  & 4   / 4   & 2   / 2   & 4   / 2   & & & & & & \\
    $(10,11,\thenBr)$    & 199    / 70.06   & 60.92  / 41.58 & 49.68  / 39.66 & 60.22  / 39.44 & 199  / 72   & 61  / 42 & 60  / 39.5  & 60  / 40   & 199  / 56  & 45  / 31  & 46  / 27 & 48  / 29  & 199  / 77  & 72  / 51  & 74  / 52  & 76  / 52  & & & & & & \\
    $(10,13,\elseBr)$    & 199    / 70.4    & 1.24   / 1.04  & 1.32   / 0.82  & 1.22   / 0.88  & 199  / 71   & 1   / 1  & 1   / 1     & 1   / 1    & 199  / 59  & 1   / 0   & 1   / 0  & 1   / 0   & 199  / 79  & 2   / 2   & 3   / 2   & 3   / 2   & & & & & & \\
    $(16,17,\inWhile)$   & 199    / 69.74   & 1.46   / 1.1   & 1.5    / 1.06  & 1.76   / 1.08  & 199  / 70   & 1   / 1  & 1   / 1     & 1   / 1    & 199  / 57  & 1   / 0   & 1   / 0  & 1   / 0   & 199  / 81  & 3   / 2   & 6   / 3   & 8   / 4   & & & & & & \\
    $(20,21,\thenBr)$    & 199    / 69.8    & 5.38   / 2.58  & 5.66   / 2.6   & 6.32   / 2.92  & 199  / 70   & 5   / 2  & 4   / 2     & 5   / 2.5  & 199  / 58  & 1   / 1   & 1   / 0  & 1   / 0   & 199  / 78  & 14  / 6   & 21  / 9   & 25  / 11  & & & & & & \\
    $(20,23,\elseBr)$    & 199    / 70.58   & 1.54   / 0.9   & 1.2    / 0.94  & 1.28   / 0.88  & 199  / 71.5 & 1   / 1  & 1   / 1     & 1   / 1    & 199  / 57  & 1   / 0   & 1   / 0  & 1   / 0   & 199  / 79  & 4   / 3   & 3   / 2   & 3   / 2   & & & & & & \\
    $(26,27,\thenBr)$    & 0      / 0.44    & 0      / 0.54  & 0      / 0.48  & 0      / 0.36  & 0    / 0    & 0   / 1  & 0   / 0     & 0   / 0    & 0    / 0   & 0   / 0   & 0   / 0  & 0   / 0   & 0    / 1   & 0   / 1   & 0   / 2   & 0   / 1   & & & & & & \\
    $(26,29,\elseBr)$    & 0      / 0.34    & 0      / 0.38  & 0      / 0.38  & 0      / 0.4   & 0    / 0    & 0   / 0  & 0   / 0     & 0   / 0    & 0    / 0   & 0   / 0   & 0   / 0  & 0   / 0   & 0    / 1   & 0   / 1   & 0   / 1   & 0   / 1   & & & & & & \\
    $(30,31,\thenBr)$    & 199    / 70.94   & 51.44  / 22.56 & 51.66  / 22.3  & 51.96  / 21.88 & 199  / 72   & 52  / 23 & 52  / 22    & 51  / 22   & 199  / 57  & 42  / 17  & 41  / 18 & 42  / 16  & 199  / 81  & 62  / 28  & 61  / 27  & 62  / 27  & & & & & & \\
    %% $(30,33,\elseBr)$ & 0      / 0.5     & 0      / 0.36  & 0      / 0.32  & 0      / 0.46  & 0    / 0.5  & 0   / 0  & 0   / 0     & 0   / 0    & 0    / 0   & 0   / 0   & 0   / 0  & 0   / 0   & 0    / 1   & 0   / 1   & 0   / 1   & 0   / 1   & & & & & & \\
    $(34,35,\thenBr)$    & 199    / 71.3    & 22.66  / 9.9   & 23.32  / 10.18 & 23.32  / 9.8   & 199  / 72   & 23  / 10 & 23  / 10    & 24  / 10   & 199  / 64  & 13  / 6   & 15  / 7  & 16  / 7   & 199  / 85  & 29  / 13  & 33  / 14  & 28  / 12  & & & & & & \\
    %% $(34,41,\elseBr)$ & 0      / 0.48    & 0      / 0.46  & 0      / 0.34  & 0      / 0.42  & 0    / 0    & 0   / 0  & 0   / 0     & 0   / 0    & 0    / 0   & 0   / 0   & 0   / 0  & 0   / 0   & 0    / 1   & 0   / 1   & 0   / 1   & 0   / 1   & & & & & & \\
    %% $(44,45,\inFor)$  & 0      / 0.38    & 0      / 0.34  & 0      / 0.42  & 0      / 0.34  & 0    / 0    & 0   / 0  & 0   / 0     & 0   / 0    & 0    / 0   & 0   / 0   & 0   / 0  & 0   / 0   & 0    / 1   & 0   / 1   & 0   / 1   & 0   / 1   & & & & & & \\
    \bottomrule
    \end{tabular}
}
\end{table*}


\subsection{Limitations}
\label{sub.sec.eval.limit}

Our framework imposes certain constraints on the structure of JS programs:
\begin{itemize}
\item no inter-procedural function calls
\item no recursion  
\end{itemize}


%% --------------------------------------------------------------------
\section{Related Work}
\label{sec:related.work}
%% --------------------------------------------------------------------

\subsection{Search-Based Test Case Generation}
\label{sub.sec.search.based}

\cite{wegener2001evolutionary} evolutionary test generation for structural coverage.

\cite{tonella2004evolutionary} evolutionary testing of classes

\cite{wappler2005using} evolutionary testing of object-oriented software.

\cite{wappler2006evolutionary} uses strongly-typed genetic programming and deals with the runtime exceptions.

\cite{lakhotia2007multi} multi-objective search-based test data generation 

\cite{cao2009search} multi-path search-based test data generation

\cite{awedikian2009mc} MC/DC test input generation 

\cite{shahbazi2016black} generation of string test data

\cite{fraser2012mutation} mutation-driven generation of unit tests and oracles

\cite{havrikov2014xmlmate} XMLMate: evolutionary XML test generation.

\cite{mcminn2004search} seminal survey of search-based test data generation techniques.

\cite{mcminn2011search} recent overview of search-based testing.

\cite{mairhofer2011search} search-based testing for dynamic languages (Ruby)

\cite{baars2011symbolic} combines dynamic analysis with symbolic information to improve search-based testing

\cite{alshahwan2011automated} automated web application testing using search based software techniques.

\cite{ma2015grt} guided random testing

\cite{mao2016sapienz} Multi-objective automated testing for Android application

\subsection{Static and Dynamic Analysis of JavaScript}
\label{sub.sec.js.static.anal}

Static analysis is a powerful technique commonly used as solid alternative for program testing. In fact both techniques can benefit from one another. For such weakly typed and dynamic languages as JavaScript employing static analysis to infer types can be an invaluable source of information to identify potential bugs or even guarantee their absence. Jensen et al.~\cite{tajs2009} presented such an analysis for JavaScript using abstract interpretation. In the follow-up work~\cite{dom2011} they extended the analysis with the abstractions to reason about HTML DOM and browser API. Given step let the authors to carry static analysis at the level of complete web application (JavaScript + HTML).
\cite{jquery2014}


ACTARUS is a static taint analysis of JS\cite{guarnieri2011saving}.

Jalangi is dynamic analysis framework for JavaScript \cite{sen2013jalangi}.

Dynamic type inconsistency analysis (implemented on top Jalangi) for JavaScript\cite{pradel2015typedevil}.

Salable dynamic analysis framework for JS based on shadow executions~\cite{create_citation}.

Information-flow security for JS~\cite{hedin2012information}.

\subsection{Whole Web Application Testing}
\label{sub.sec.web.app.test}

Artemis~\cite{artemis2011} is a feedback-directed random testing tool for JavaScript web application. It discoverers new tests by generating sequences of executable events and monitoring they effect on the state of the application. \cite{ail2013}

Testing of AJAX application by means of crawling of the application to infer state-flow graph~\cite{mesbah2012crawling} ATUSA ~\cite{mesbah2012invariant}

Learning DOM invariants from multiple executions of the application~\cite{pattabiraman2010dodom}.

Measuring test adequacy for web application based on the DOM state coverage~\cite{mirzaaghaei2014dom}.

Combining human written test cases with the automatically generated once by crawling in order to extend test coverage~\cite{milani2014leveraging}.

DOM-aware JavaScript code completion~\cite{bajaj2014dompletion}. 

\subsection{Formal Techniques}
\label{sub.sec.formal}

Modeling and reasoning about DOM events~\cite{lerner2012modeling}.

\subsection{JavaScript Unit Testing}
\label{sub.sec.js.unit.test}

Generating fixture for JavaScript unit tests by means of concolic execution~\cite{amin:ase15}. Inference of UI oracles to complement JS unit tests~\cite{icst16}.

JS unit test generation by means of symbolic execution~\cite{tanida2014automatic}.

Flycatcher~\cite{deautomatic}

\subsection{Misc JavaScript Testing Techniques}
\label{sub.sec.misc.test.tech}

Discover patterns from bug fixes and imposing them as potential bugs in the future~\cite{quinn:fse16}. 

\section{Conclusion}
\label{sec:concl}
1 page.

\bibliographystyle{ACM-Reference-Format}
\bibliography{icse2018.bib} 


\end{document}
